# 파일
**파일**: 고유한 이름을 가지며 디스크에 정보가 저장되는 단위   
> 파일은 CPU나 메모리에 존재하지 않으며 하드 디스크나 CD-ROM등의 외부 미디어에 기록되어 있다.

<br><br>

**<파일 액세스 방법>**
1. 고수준 입출력 스트림 사용: C 라이브러리가 제공하는 파일 입출력 방법, 표준에 의해 함수의 형태가 고정되어 있으므로 이식에 유리.  
2. 저수준 파일 핸들: C 라이브러리가 제공하는 파일 입출력 방법, 대규모의 데이터를 다룰 때 편리.  
3. C++의 스트림 객체 : ifstream, ofstream 등의 입출력 객체와 그 멤버 함수를 사용하여 파일을 액세스.  
4. 운영체제가 제공하는 API 함수 : 윈도우즈가 제공하는 CreateFile, ReadFile, WriteFile 등의 함수를 사용하여 파일을 액세스 가능.  
5. 클래스 라이브러리가 제공한 파일액세스 객체 사용 : 고수준 클래스 라이브러리가 파일액세스 기능을 캡슐화하여 제공한 클래스를 사용.  

|C언어 파일 입출력 방식|고수준|저수준|
|----|----|----|
|버퍼 사용|사용|메모리로 직접 읽어들임|
|입출력 대상|스트림|파일 핸들|
|속도|느림|빠름|
|문자 단위 입출력|가능|가능하지만 비효율|
|난이도|비교적 쉬움|어려움|
|세밀한 조작|어려움|가능|

<br><br><br><br><br>
# 스트림
**스트림**: 바이트들이 순서대로 입출력되는 논리적인 장치  
> 대부분 운영채제는 키보드와 화면, 프린터 등을 스트림이라는 동질적인 장치로 다루며 파일과 같은 방법으로 입출력 한다.  
> 파일,키보드 등 장치는 서로 제어하는 방법이 다르나 스트림이라는 논리적으로 동등한 장치로 표현되어 동일한 방법으로 입출력 가능.  
> 스트림은 내부에 입출력 버퍼를 가지며, 이 버퍼는 스트림에 의해 자동으로 관리되므로 프로그래머는 버퍼를 준비,관리할 필요가 없다.

<br><br><br><br><br>
# 파일 열기
**Open**: 파일 입출력을 위한 준비를 하는 것  
&nbsp;&nbsp;&nbsp;**형태**: FILE *fopen(const char *filename, const char *mode);  
> 스트림 입출력을 위해선 파일의 데이터를 잠시 저장하는 내부 버퍼가 필요하며 파일의 현재 위치(FP)를 초기화하는 과정이 Open이다.

<br><br>

**<파일 이름**>
1. 파일 이름에는 필요할 경우 드라이브와 디렉토리 경로를 전달할 수 있으며 현재 위치를 기준으로 한 상대 경로를 지정할 수도 있다.  
2. 파일 이름에 경로가 생략되고 파일 이름만 주어질 경우 현재 디렉토리에서 파일을 찾는다.  
3. 디렉토리 구분자로 사용되는 역슬레쉬 문자는 문자열 내에서 확장열 표시에 사용되므로 반드시 \\로 써야 한다.  
4. 파일명의 대소문자 구분 여부는 운영체제에 따라 다르지만 도스나 윈도우즈는 상관없으며 리눅스나 유닉스는 구분해야 한다.

<br><br>

|모드|설명|
|----|----|
|r|읽기 전용 파일로 열기. 이 모드로 연 파일은 읽을 수만 있으며 데이터를 기록하지는 못한다. 만약 파일이 없을 경우 에러가 리턴|
|w|쓰기 전용 파일로 열기. 이 모드로 연 파일은 쓰기만 가능하며 읽지는 못한다. 도스나 윈도우즈의 파일은 쓰기 전용 속성이 없지만 스트림은 쓰기 전용 상태로 열 수 있다.파일이 없으면 새로 만들고 이미 존재한다면 기존의 파일은 삭제.|
|a|추가를 위해 파일을 열기. 이 모드로 연 파일은 오픈 직후에 FP가 파일의 끝으로 이동한다. 파일이 없으면 새로 만든다|
|r+|읽고 쓰기가 가능하도록 파일을 연다. 파일이 없을 경우 에러가 리턴|
|w+|읽고 쓰기가 가능하도록 파일을 연다. 파일이 없을 경우 새로 만듦|
|a+|읽기와 추가가 가능하도록 파일을 연다. 파일이 없으면 새로 만듦|

> 추가는 파일의 끝에 다른 정보를 더 써 넣는다는 뜻이다.  
> mode 인수에 파일의 형태를 지정하는 플래그를 추가 지정할 수 있다.(텍스트 t, 이진 파일 b)  
> 파일 형태에 아무런 지정이 없으면 전역변수 _fnmode의 값이 사용된다.

<br><br>
 
**<파일 형태 변환>**
1. 개행 코드를 의미하는 CR/LF 조합은 LF로 변환되어 읽혀지며 LF를 기록하면 CR/LF가 출력.
2. 파일의 끝을 나타내는 Ctrl+Z(0x1A)는 EOF(-1)로 변환되어 읽혀진다. 단 "a+" 모드로 열었을 때는 끝부분에 데이터를 추가할 수 있도록 Ctrl+Z를 제거

> 이진 파일은 아무런 변환없이 읽혀지지만 텍스트 파일 형태로 열 경우 변환이 일어난다.  
> LF 변환을 해 주는 이유는 C 문자열 출력 함수들은 개행을 위해 확장열 LF(\n)를 사용하기 때문이다.  
> 오픈 모드와 파일 형태가 mode 인수에 같이 기록되는데 오픈 모드가 먼저 오고 파일 형태가 뒤에 오는 형식으로 써야 한다. 단, +문자는 파일 형태 다음에 와도 상관없다.  
> 모드 인수는 문자열이므로 겹따옴표를" 써야한다.  
> 이외에 mode 인수에는 캐시를 관리하는 방법과 임시 파일 생성에 대한 몇 가지 플래그를 더 지정할 수 있다.

<pre>▶ "rt" : 텍스트 파일을 읽기 전용으로 연다.
▶ "wb" : 이진 파일을 쓰기 전용으로 연다.
▶ "r+b" : 이진 파일을 읽기, 쓰기 가능하도록 연다. "rb+"로 쓸 수도 있다.</pre>

<br><br>

**리턴값**: fopen은 지정한 파일을 지정한 모드로 열고 입출력에 필요한 FILE 구조체를 생성한 후 그 포인터를 리턴
> 에러가 발생하면 NULL을 리턴

<br><br>

**close**: 파일을 닫는 과정  
&nbsp;&nbsp;&nbsp;**형태**: int fclose(FILE *stream);  
> 버퍼에 남아있는 데이터를 파일로 완전히 출력 후 내부적으로 생성했던 FILE 구조체를 해제한다.  
> 다 사용한 파일은 반드시 닫아야한다.  
